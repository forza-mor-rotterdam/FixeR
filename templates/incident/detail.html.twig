{% extends 'base.html.twig' %}

{% block title %}{{ incident.locatie.adres.straatNaam }} {{ incident.locatie.adres.huisnummer }}{% endblock %}

{% block body %}


    <section class="section--seperated">
        <div class="full-width">
        {% if incident.fotos|length > 0 %}
            <div class="container__imageslider">
                <div class="container__image">
                    <img src="{{ path('app_image_full', {'id': incident.fotos|first.id}) }}" alt="" />
                </div>
                {% if incident.fotos|length > 1 %}
                <div class="container__thumbs">
                    <ul>
                        {% for foto in incident.fotos %}
                        <li>
                            <div class="container__image">
                                <img src="{{ path('app_image_full', {'id': foto.id}) }}?thumbnail=true" alt="" />
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        {% else %}
            <div class="no-image" style="background-image: url('{{ asset('build/icons/noimage.svg') }}');"></div>
        {% endif %}
        </div>
    </section>

    <section class="section--seperated">
        <div class="container__details">
        {# TODO add optional huisletter and huisnummer_toevoeging  #}
            <h1 class="h3">{{ incident.locatie.adres.straatNaam }} {{ incident.locatie.adres.huisnummer }}</h1>
            <span>
                {{ incident.datumMelding | date('d-m-Y') }} 
                {{ incident.datumMelding | date('H:i') }}
            </span>

            <h2 class="h5">Omschrijving</h2>
            <p>
                {{ incident.omschrijving }}
            </p>
            <h2 class="h5">Onderwerp</h2>
            <p>
                {{ incident.onderwerp.omschrijving }}
            </p>
            <h2 class="h5">Afdeling</h2>
            <p>
                {{ incident.onderwerp.omschrijving }}
            </p>

            <h2 class="h5">Melding {{ incident.id }}</h2>
            <p>
                Status: {{ incident.status }}
            </p>

        </div>
    </section>

    <section class="section--seperated">
        <div class="container__details">
            <h2 class="h5">Locatie</h2>
            <p>
                <a href="#" class="link--location">{{ incident.locatie.adres.straatNaam }} {{ incident.locatie.adres.huisnummer }}</a>
            </p>
            <dl>
            {# if wijk.. #}
                <div>
                    <dt>Wijk:</dt>
                    <dd></dd>
                </div>
            {# if buurt.. #}
                <div>
                    <dt>Buurt:</dt>
                    <dd></dd>
                </div>
            {# if subbuurt.. #}
                <div>
                    <dt>Subbuurt:</dt>
                    <dd>{{ incident.locatie.subbuurt }}</dd>
                </div>
                {% if incident.locatie.plaatsbepaling|default %}
                <div>
                    <dt>Plaatsbepaling:</dt>
                    <dd>{{ incident.locatie.plaatsbepaling }}</dd>
                </div>
                {% endif %}
            </dl>
        </div>
    </section>

    <section class="section--seperated">
        <div class="container__details">
            <h2 class="h5">Gemeld door</h2>
            <ul class="list-clean incident-meta-list">
                {% if incident.melder.herkomst|default %}
                <li>
                    <p class="text--person">{{ incident.melder.herkomst }}</p>
                </li>
                {% endif %}
                {% if incident.melder.telefoon|default %}
                <li>
                    <a href="tel:{{ incident.melder.telefoon }}" class="link--phone">{{ incident.melder.telefoon }}</a>
                </li>
                {% endif %}
                {% if incident.melder.email|default %}
                <li>
                    <a href="mailto:{{ incident.melder.email }}" class="link--email">{{ incident.melder.email }}</a>
                </li>
                {% endif %}
                {% if incident.melder.informeren is same as("Nee") %}
                <li>
                    <p class="text--close">De melder wil niet op de hoogte blijven</p>
                </li>
                {% endif %}
            </ul>
        </div>
    </section>

    <section class="section--seperated">
        <div class="container__details">
            <ul class="list-clean incident-meta-list">
                {% if incident.magInBehandelingNemen %}
                <li>
                    <a href="#" class="link--next">In behandeling nemen</a>
                </li>
                {% endif %}
                {% if incident.magDoorsturenMelddesk %}
                <li>
                    <a href="#" class="link--next">Doorsturen naar Meld desk</a>
                </li>
                {% endif %}
            </ul>
            {% if incident.magAfhandelen %}
                <div class="form-row" data-controller="incident" >
                    <button 
                        class="btn btn-action"
                        data-id="{{ incident.id }}"
                        data-incident-object-param = "{{ incident|json_encode() }}"
                        data-action="click->incident#openModal"
                    >
                        Afhandelen
                    </button>
                </div>
            {% endif %}
            {% if incident.magDoorverwijzen %}
                <div class="form-row">
                    <button class="btn btn-tertiary">Doorverwijzen</button>
                </div>
            {% endif %}
        </div>
    </section>

    {% include('./snippets/modal_form_handle.html.twig') %}

{% endblock %}
