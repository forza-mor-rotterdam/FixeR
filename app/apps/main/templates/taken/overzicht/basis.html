{% extends "base.html" %}
{% load json_encode from main_tags %}
{% block title %}
    Taken | FixeR
{% endblock title %}
{% block body %}
    <turbo-frame id="taak_basis" data-turbo-action="advance">
    <form action="{% url 'taken_overzicht' %}"
          method="post"
          class="filter-form"
          data-controller="filter"
          data-turbo-frame="false"
          id="incidentFilterAllForm"
          data-testid="incidentFilterAllForm">
        {% csrf_token %}
        <div class="page-incidents"
             data-incidents-filters-value="{{ filters|json_encode }}"
             data-controller="incidentlist"
             data-incidentlist-takenKaart-outlet="#taken_kaart"
             id="taken">
            <div class="container__header" data-incidentlist-target="containerHeader">
                <div class="row">
                    <h1 class="h3">
                        Taken (<span data-incidentlist-target="takenCount" id="stream_taken_aantal">{{ page_obj.paginator.count }}</span>)
                    </h1>
                    <div class="container__controls">
                        <button type="button"
                                class="btn btn-secondary btn-sort--small"
                                data-action="incidentlist#onToggleSearchContainer"
                                aria-label="Toon zoekveld">
                            <span>{% include "icons/search.svg" %}</span>
                        </button>
                        <button type="button"
                                class="btn btn-secondary btn-sort--small"
                                data-action="incidentlist#onToggleSortingContainer"
                                aria-label="Sorteer de lijst">
                            <span>{% include "icons/sort.svg" %}</span>
                        </button>
                        {% if request.user.profiel.context.template == "standaard" %}
                            <button type="button"
                                    class="btn btn-secondary btn-navigate--small toggle-view"
                                    data-action="incidentlist#toggleMapView"
                                    data-incidentlist-target="toggleMapView"
                                    aria-label="Maak route">
                                {% include "icons/kaart.svg" %}
                                {% include "icons/lijst.svg" %}
                            </button>
                        {% endif %}
                        <div class="wrapper wrapper--search">
                            {{ form.q }}
                            <button class="hide"
                                    type="button"
                                    data-filter-target="cancelZoek"
                                    data-action="filter#onCancelSearch">{% include "icons/close.svg" %}</button>
                        </div>
                        <button type="button"
                                class="btn btn-secondary btn-filter--small"
                                data-action="main#showFilters">
                            <span>{% include "icons/filter.svg" %}</span>
                            <span>Filter</span>
                            <span class="count count--filter" data-filter-target="selectedChoicesCount"></span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="container__list">
                <div class="container__flex list--navigation-tools">
                    <div class="container__sorting hidden-vertical"
                         data-incidentlist-target="sorting">{{ form.sorteer_opties }}</div>
                    <div class="container__search hidden-vertical"
                         data-incidentlist-target="search"></div>
                    <div class="list__incidents"
                         data-testid="incidentsList"
                         id="taken_lijst"
                         data-incidentlist-target="incidentlist">
                        <div id="stream_taken_lijst">{% include "taken/overzicht/lijst.html" %}</div>
                    </div>
                </div>
                {% include "taken/overzicht/kaart.html" %}
            </div>
        </div>
        <div class="full-page-view full-page-view__filters" tabindex="0">
            <div class="full-page-view__main">
                <div class="full-page-view__header">
                    <div class="full-page-view__action_container">
                        <h2 class="full-page-view__title">Filters</h2>
                        <button type="button"
                                class="btn btn-close"
                                aria-label="Sluit"
                                data-action="main#hideFilters"></button>
                    </div>
                </div>
                <div class="full-page-view__scroll-pane">
                    <div class="full-page-view__content">
                        <div>{% include "taken/overzicht/filter_form.html" %}</div>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <dialog class="infosheet" data-infosheet-target="infosheet">
        <turbo-frame id="infosheet" data-infosheet-target="infosheetTurboframe"></turbo-frame>
    </dialog>
    </turbo-frame>
{% endblock body %}
