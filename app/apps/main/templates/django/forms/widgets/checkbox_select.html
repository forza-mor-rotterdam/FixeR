{% load rotterdam_formulier_html %}
{% load l10n %}
{% load file_exists from main_tags %}
{% with id=widget.attrs.id %}
    <div id="{{ id }}">
        <ul class="{% if widget.attrs.classList %}{{ widget.attrs.classList }}{% else %}list--form-check-input{% endif %}">
            {% for group, options, index in widget.optgroups %}
                {% if group %}
                    <li>
                        {{ group }}
                        <ul {% if id %}id="{{ id }}_{{ index }}"{% endif %}>
                        {% endif %}
                        {% for option in options %}
                            <p>Option: {{ option }}</p>
                            <li class="{% if widget.required and form.required_css_class %}{{ form.required_css_class }}{% endif %}">
                                <div class="form-check">
                                    <p>ID FOR LABEL: {{ option }}</p>
                                    <input type="checkbox"
                                           name="{{ widget.name }}"
                                           {% include "django/forms/widgets/attrs.html" %}
                                           value="{{ option.value }}"
                                           {% if option.selected %}checked{% endif %}
                                           {% if widget.required %}required{% endif %}
                                           class="form-check-input"
                                           id="{{ id }}"
                                           --
                                           Hide
                                           the
                                           checkbox
                                           -->
                                    <label class="form-check-label"
                                           for="{{ id }}"
                                           name="{{ widget.name }}"
                                           value="{{ option.value }}"
                                           id="{{ option.id_for_label }}"
                                           {% if option.selected %}checked{% endif %}
                                           {% if widget.required %}required{% endif %}
                                           {% include "django/forms/widgets/attrs.html" %}>
                                        {% if widget.attrs.hasIcon %}
                                            {% with option.label|slugify as slugged_option_label %}
                                                {% with "icons/afdelingen/"|add:slugged_option_label|add:".svg" as icon_path %}
                                                    {% if icon_path|file_exists %}
                                                        {% include icon_path %}
                                                    {% else %}
                                                        {% include "icons/noimage.svg" %}
                                                    {% endif %}
                                                {% endwith %}
                                            {% endwith %}
                                        {% endif %}
                                        {{ option.label }}
                                    </label>
                                </div>
                            </li>
                        {% endfor %}
                        {% if group %}
                        </ul>
                    </li>
                {% endif %}
            {% endfor %}
        </ul>
        {% for error in widget.errors %}
            <span class="help-block invalid-text {{ form.error_css_class }}">{{ error }}</span>
        {% endfor %}
    </div>
{% endwith %}
